<!DOCTYPE html>
<html lang="en">
<head>
    <title>Serendipity Styx Edition - Help Center [en] | ophian.github.io</title>
    <meta charset="UTF-8">
    <meta name="description" content="Serendipity Styx is a PHP-powered weblog engine giving users an easy way to maintain a blog and developers a framework with the power for professional applications.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="Serendipity Styx Edition - Help Center [en] | Styx is what Serendipity should be | ophian.github.io">
    <meta property="og:site_name" content="Serendipity Styx Blog System">
    <meta property="og:description" content="Serendipity Styx is a PHP-powered weblog engine giving users an easy way to maintain a blog and developers a framework with the power for professional applications.">
    <meta property="og:image" content="https://ophian.github.io/i/styx-opengraph.jpg">
    <meta property="og:url" content="https://ophian.github.io/">
    <link rel="canonical" href="https://ophian.github.io/hc/en/shared-installation.html">
    <link rel="apple-touch-icon" href="/i/apple-touch-icon.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito|Nunito+Sans">
    <link rel="stylesheet" href="/css/libs.min.css">
    <link rel="stylesheet" href="/css/styx.min.css">
</head>
<body>
<ul class="skip-link__list">
    <li class="skip-link skip-link--main-nav">
        <a href="#main-navigation" tabindex="1">Main navigation</a>
    </li>
    <li class="skip-link skip-link--main-repo"><a href="#main-repository" tabindex="1">Styx Repository</a></li>
    <li class="skip-link skip-link--main-content"><a href="#main-content" tabindex="1">Styx Main content</a></li>
</ul>
<div class="menu menu--no-hero menu--tiny ">
    <div class="menu__page-title">
        <h1><a href="/hc/en">Serendipity Styx Edition - Documentation [en]</a></h1>
    </div>
    <div class="progress-bar" aria-hidden="true"><span class="progress-bar__fill"></span></div>
</div>
<div class="site-nav site-nav--no-hero menu--tiny">
    <button class="site-nav__toggler" id="site-nav__toggler" aria-label="Show website navigation" aria-expanded="false" tabindex="1">
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
    </button>
</div>
<div class="site-nav__panel" aria-hidden="true" aria-controls="site-nav__toggler">
    <nav id="main-navigation" role="navigation" aria-label="main navigation">
        <ul class="site-nav__menu">
            <li class="site-nav__menu-item site-nav__menu-item--current"><a href="/hc/en" tabindex="-1" title="Serendipity Styx Help Center [en]">Documentation [en]</a></li>
        </ul>
        <p class="site-nav__menu-category">Main</p>
        <ul class="site-nav__menu" aria-label="links to styx site main pages">
            <li class="site-nav__menu-item"><a href="/" tabindex="-1" title="Serendipity Styx Home">Styx Home</a></li>
            <li class="site-nav__menu-item"><a href="/blog" tabindex="-1" title="Serendipity Styx Blog">Styx Blog</a></li>
            <li class="site-nav__menu-item"><a href="/blog/archives" tabindex="-1" title="Serendipity Styx Blog Archives">Styx Blog Archives</a></li>
            <li class="site-nav__menu-item"><a href="/atom.xml" tabindex="-1" title="Serendipity Styx Blog Feed">Styx Blog Feed</a></li>
            <li class="site-nav__menu-item"><a href="/about" tabindex="-1" title="About Serendipity Styx">About Styx</a></li>
        </ul>
        <p class="site-nav__menu-category">Spartacus</p>
        <ul class="site-nav__menu" aria-label="links to styx spartacus pages">
            <li class="site-nav__menu-item"><a href="/plugins" tabindex="-1" title="Serendipity Styx Spartacus Plugins">Styx Spartacus Plugins</a></li>
            <li class="site-nav__menu-item"><a href="/themes" tabindex="-1" title="Serendipity Styx Spartacus Themes">Styx Spartacus Themes</a></li>
        </ul>
        <p class="site-nav__menu-category">Repository</p>
        <ul class="site-nav__menu" aria-label="links to styx repository pages">
            <li class="site-nav__menu-item"><a class="icon icon--small" href="https://github.com/ophian/styx" target="_blank" rel="noopener" tabindex="-1" title="GitHub Serendipity Styx Code"><svg class="icon__body"><use xlink:href="#github"></use></svg> Styx Code</a></li>
            <li class="site-nav__menu-item"><a class="icon icon--small" href="https://github.com/ophian/styx/releases" target="_blank" rel="noopener" tabindex="-1" title="GitHub Serendipity Styx Releases"><svg class="icon__body"><use xlink:href="#github"></use></svg> Styx Downloads</a></li>
            <li class="site-nav__menu-item"><a class="icon icon--small" href="https://github.com/ophian/additional_plugins" target="_blank" rel="noopener" tabindex="-1" title="GitHub Serendipity Styx Plugins"><svg class="icon__body"><use xlink:href="#github"></use></svg> Styx Plugins</a></li>
            <li class="site-nav__menu-item"><a class="icon icon--small" href="https://github.com/ophian/styx/issues" target="_blank" rel="noopener" tabindex="-1" title="GitHub Serendipity Styx Issues"><svg class="icon__body"><use xlink:href="#github"></use></svg> Styx Issues</a></li>
        </ul>
        <p class="site-nav__menu-category">Book</p>
        <ul class="site-nav__menu" aria-label="link book page">
            <li class="site-nav__menu-item"><a href="/book" tabindex="-1" title="Documentation Serendipity Styx Book [de] page">Styx Book [de]</a></li>
        </ul>
        <p class="site-nav__menu-category">Connect & Help</p>
        <ul class="site-nav__menu" aria-label="links connect and help pages">
            <li class="site-nav__menu-item"><a href="/hc" tabindex="-1" title="Serendipity Styx Help Center">Help center</a></li>
            <li class="site-nav__menu-item"><a href="/hc/de" tabindex="-1" title="Serendipity Styx Hilfeseiten">Hilfeseiten</a></li>
            <li class="site-nav__menu-item"><a href="/hc/en/faq" tabindex="-1" title="Serendipity Styx FAQ">Styx FAQ</a></li>
            <li class="site-nav__menu-item"><a href="/contact" tabindex="-1" title="Serendipity Styx Contact">Contact Styx</a></li>
        </ul>
    </nav>
</div>
<div class="site-cover"></div>
<main class="site-content site-content--col site-content--no-hero site-content--simple" id="main-content" role="main">
    <section class="section site-col" data-reading-progress="true">
        <div class="col">
            <div class="col-menu__wrapper">
                <nav class="col-menu" role="navigation" aria-label="Help Center [en] documents navigation">
                    <ul>
                        <li><a href="/hc/"><img src="/i/info_icon-64.png" width="32" height="32"> Styx Help Center</a></li>
                        <li><a href="/hc/en/">Documentation [en]</a></li>
                        <li><a href="/hc/de/">Dokumentation [de]</a></li>
                        <li><a href="/hc/en/faq/">Styx Help Center FAQ</a></li>
                    </ul>
                </nav>
            </div>
            <div class="col-document__wrapper col-document__wrapper-documents">
                <div class="col-document">
                    <h1><span class="hc-home"><a href="index.html" title="Styx Help Center [en]">⌘</a></span> - Shared installations</h1>
                    <ul class="document-nav">
                        <li class="document-up"><a href="index.html"><span class="icon arrow-left">←</span> back to main page</a></li>
                        <li class="document-current">« Shared installation »</li>
                        <li class="document-next">« End of guided Tour »</li>
                    </ul>
                    <h2 id="docs-shared-installation">Shared installation</h2>

<p>(WARNING: This feature is nothing new - but still marked “EXPERIMENTAL”!)</p>

<p>You can install ONE s9y distribution and manage multiple users on it by sharing the core files and then deploying specially crafted files in each user’s directory.</p>

<p>Let’s do this using an example. You own the domain ‘s9yblogs.org’. You want to have multiple virtual hosts for as many users as you like. They are going to be called ‘username.s9yblogs.org’. We choose the users ‘garvin’, ‘j’ and ‘tom’ for example hosts. We assume that your webserver runs as user ‘www’, group ‘www’. We also assume that all your users are called like the subdomains, and they are also in group ‘www’. We further assume that PHP’s safe_mod is turned off.</p>

<p>Of course, for security reasons, you should set the open_basedir directive to the user’s document root, so he can’t access other installations on your host.</p>

<p>So your Apache-Webserver should contain Virtual Hosts like this:</p>

<pre><code>-- httpd.conf
&lt;VirtualHost 42.42.42.42:80&gt;
    ServerName garvin.s9yblogs.org
    DocumentRoot /home/www/garvin.s9yblogs.org/htdocs
    &lt;Directory "/home/www/garvin.s9yblogs.org/htdocs"&gt;
        AllowOverride All
    &lt;/Directory&gt;
    php_value include_path ".:/usr/local/lib/php:/usr/local/lib/php/s9y/:/usr/local/lib/php/s9y/bundled-libs/"
    php_admin_value open_basedir "/usr/local/lib/php/:/usr/local/lib/php/s9y/:/home/www/garvin.s9yblogs.org/"
&lt;/VirtualHost&gt;

&lt;VirtualHost 42.42.42.42:80&gt;
    ServerName j.s9yblogs.org
    DocumentRoot /home/www/j.s9yblogs.org/htdocs
    &lt;Directory "/home/www/j.s9yblogs.org/htdocs"&gt;
        AllowOverride All
    &lt;/Directory&gt;
    php_value include_path ".:/usr/local/lib/php:/usr/local/lib/php/s9y/:/usr/local/lib/php/s9y/bundled-libs/"
    php_admin_value open_basedir "/usr/local/lib/php/:/usr/local/lib/php/s9y/:/home/www/j.s9yblogs.org/"
&lt;/VirtualHost&gt;

&lt;VirtualHost 42.42.42.42:80&gt;
    ServerName tom.s9yblogs.org
    DocumentRoot /home/www/tom.s9yblogs.org/htdocs
    &lt;Directory "/home/www/tom.s9yblogs.org/htdocs"&gt;
        AllowOverride All
    &lt;/Directory&gt;
    php_value include_path ".:/usr/local/lib/php:/usr/local/lib/php/s9y/:/usr/local/lib/php/s9y/bundled-libs/"
    php_admin_value open_basedir "/usr/local/lib/php/:/usr/local/lib/php/s9y/:/home/www/tom.s9yblogs.org/"
&lt;/VirtualHost&gt;
-- httpd.conf</code></pre>

<p>You will unpack the default s9y distribution files in “/usr/local/lib/php/s9y/”. Where you store the directory ‘s9y’ is not important, as long as you adjust the include_path setting in the Virtual Hosts. But the directory name ‘s9y’ is significant.</p>

<p>Now you can either <strong>copy</strong> or <strong>link</strong> the following subcategories:</p>

<ul>
  <li>“/usr/local/lib/php/s9y/deployment/” [core redirection files]</li>
  <li>“/usr/local/lib/php/s9y/templates/” [templates so that users can change them - depends on your plugin usage!]</li>
  <li>“/usr/local/lib/php/s9y/plugins/” [certain plugins refer to HTTP-images]</li>
  <li>“/usr/local/lib/php/s9y/htmlarea/” [htmlarea WYSIWYG-editor]</li>
</ul>

<p>to each of the user’s subdirectories:</p>

<pre><code>$ cp -r /usr/local/lib/php/s9y/deployment/* /home/www/garvin.s9yblogs.org/htdocs/

/* Either COPY: */
$ cp -r /usr/local/lib/php/s9y/templates /home/www/garvin.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/plugins /home/www/garvin.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/htmlarea /home/www/garvin.s9yblogs.org/htdocs/

/* Or LINK: */
$ ln -s -d /usr/local/lib/php/s9y/templates /home/www/garvin.s9yblogs.org/htdocs/templates
$ ln -s -d /usr/local/lib/php/s9y/plugins /home/www/garvin.s9yblogs.org/htdocs/plugins
$ ln -s -d /usr/local/lib/php/s9y/htmlarea /home/www/garvin.s9yblogs.org/htdocs/htmlarea

/* Adjust permissions */
$ chown -R garvin.www /home/www/garvin.s9yblogs.org/htdocs/*
$ chmod ug+rwx /home/www/garvin.s9yblogs.org/htdocs
$ chmod ug+rwx /home/www/garvin.s9yblogs.org/htdocs/uploads/

/* See above if you only want to link the subdirectories */
$ cp -r /usr/local/lib/php/s9y/deployment/* /home/www/j.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/templates /home/www/j.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/htmlarea /home/www/j.s9yblogs.org/htdocs/
$ chown -R j.www /home/www/j.s9yblogs.org/htdocs/*
$ chmod ug+rwx /home/www/j.s9yblogs.org/htdocs
$ chmod ug+rwx /home/www/j.s9yblogs.org/htdocs/uploads/

/* See above if you only want to link the subdirectories */
$ cp -r /usr/local/lib/php/s9y/deployment/* /home/www/tom.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/templates /home/www/tom.s9yblogs.org/htdocs/
$ cp -r /usr/local/lib/php/s9y/htmlarea /home/www/tom.s9yblogs.org/htdocs/
$ chown -R tom.www /home/www/tom.s9yblogs.org/htdocs/*
$ chmod ug+rwx /home/www/tom.s9yblogs.org/htdocs
$ chmod ug+rwx /home/www/tom.s9yblogs.org/htdocs/uploads/</code></pre>

<p>The difference between copying or linking the <strong>htmlarea</strong> and <strong>templates</strong> folder is a maintaineance issue. Whenever you upgrade the core s9y libraries, it could happen that the distributed templates or the htmlarea code could have changed. Now you only copied those directories, you need to copy the new files inside each of the user’s directories. If you only linked them, it will be instantly all the same for every user. It is recommended to link the directories, but that depends on your OS and permission structure. Of course this way a “shared library user” cannot store his own templates inside the linked directory, so this is at a loss of individualisation.</p>

<p>For later management access, it is advised you keep a list of all URLs for your s9y-managed blogs. We suggest to create a SQL table like ‘my_managed_s9y_blogs’:</p>

<pre><code>sql&gt; CREATE TABLE my_managed_s9y_blogs (url varchar(255) default null);
sql&gt; INSERT INTO my_managed_s9y_blogs (url) VALUES ('http://garvin.s9yblogs.org/');
sql&gt; INSERT INTO my_managed_s9y_blogs (url) VALUES ('http://j.s9yblogs.org/');
sql&gt; INSERT INTO my_managed_s9y_blogs (url) VALUES ('http://tom.s9yblogs.org/');</code></pre>

<p>Now you are almost ready for take-off. We assume that every user has access to a separate SQL database where his blog-data is later stored in. You can already see, that the steps needed above shouldn’t be to hard to put into a customized script.sh file for use in your setup.</p>

<p>Open up your <code>http://garvin.s9yblogs.org/</code> file. You should now see s9y’s installation screen. Enter the database- and username and the corresponding password. Everything else can be left to the user.</p>

<p>Now every user can manage his/her blog just as if it were a standalone installation.</p>

<h3 id="docs-special-notes">Special Notes</h3>

<ul>
  <li>Each blog is still a standalone blog.</li>
  <li>If you update the core library files from version 0.5 to 0.6 (for example) every user of your core library will get the default s9y-Upgrader script to see and needs to update his local configuration.</li>
</ul>

<p>As a provider for s9y blogs to your users, you are advised to migrate the user’s blogs on your own. To do so, it is best that you always have a “spare” testing blog installed just like your user’s blogs.</p>

<p>Open that installation and look at the upgrader. Execute it and see that it completes without errors. If that happened, you should cycle through a list of ALL your s9y-managed blogs like this:</p>

<pre><code>&lt;?php
$sql = mysql_query('SELECT url FROM my_managed_s9y_blogs');
while ($row = mysql_fetch_array($sql, MYSQL_ASSOC)) {
    $fp = fopen($row['url'] . 'serendipity_admin.php?serendipity[action]=upgrade');
}
?&gt;</code></pre>

<p>So basically all you need to do is call that script for every s9y-powered blog you host.</p>

                </div>
            </div>
        </div>
        <div class="blog-post__footer">
            <div class="blog-post__footer-author site-col__footer-author-container">
                <div class="blog-post__author-avatar-container">
                    <div class="blog-post__author-avatar blog-post__author-avatar--ophian"></div>
                </div>
                <div class="blog-post__author-description">
                    <h3>Ian Styx (ophian)<span>Maintainer</span></h3>
                    <p class="follow"><a href="https://github.com/ophian/styx/issues" title="Styx issues" target="_blank">@ophian</a></p>
                    <p>John Ian Styx has more than 17 years of experience in the IT market as a developer and from 2003 as a Serendipity lover.</p>
                </div>
            </div>
        </div>
    </section>
</main>
<div class="addthis_float_share_toolbox"></div>
<footer class="footer footer--blog" role="contentinfo">
    <div class="section-container footer-site-map">
        <div class="row footer-menu__row">
            <div class="col-xs-12 col-sm-4 footer-menu__container">
                <div class="footer-menu__wrapper" role="navigation" aria-labelledby="menu-category-1-0">
                    <h2 id="menu-category-1-0">Repository</h2>
                    <ul class="footer-menu">
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx/releases" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Downloads</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Code</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/additional_plugins" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Plugins</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx/issues" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Issues</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 footer-menu__container">
                <div class="footer-menu__wrapper" role="navigation" aria-labelledby="menu-category-1-1">
                    <h2 id="menu-category-1-1">Site & Documentation</h2>
                    <ul class="footer-menu">
                        <li class="icon-site"><a href="/">Serendipity Styx Home</a></li>
                        <li class="icon-site"><a href="/blog">Serendipity Styx Blog</a></li>
                        <li class="icon-site"><a href="/book">Serendipity Styx Book [de]</a></li>
                        <li class="icon-site"><a href="/plugins">Serendipity Styx Plugins</a></li>
                        <li class="icon-site"><a href="/themes">Serendipity Styx Themes</a></li>
                        <li class="icon-site"><a href="/hc/en/faq">Serendipity Styx FAQ</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 footer-menu__container">
                <div class="footer-menu__wrapper" role="navigation" aria-labelledby="menu-category-1-2">
                    <h2 id="menu-category-1-2">Connect with Styx</h2>
                    <ul class="footer-menu">
                        <li class="icon-site"><a href="/contact">Contact us</a></li>
                        <li class="icon-site"><a href="/hc">Help center</a></li>
                        <li class="icon-site"><a href="/about">About Styx</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-mobile" role="navigation" aria-hidden="true" data-mobile="true">
        <div class="section-container">
            <div class="row">
                <div class="col-xs-12 col-sm-6 footer-mobile__column">
                    <h2>Repository</h2>
                    <ul class="footer-mobile__menu">
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx/releases" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Downloads</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Code</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/additional_plugins" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Plugins</a></li>
                        <li><a class="icon icon--small" href="https://github.com/ophian/styx/issues" target="_blank" rel="noopener"><svg class="icon__body"><use xlink:href="#github"></use></svg> Serendipity Styx Issues</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-6 footer-mobile__column">
                    <h2>Connect with Styx</h2>
                    <ul class="footer-mobile__menu">
                        <li class="icon-site"><a href="/contact">Contact us</a></li>
                        <li class="icon-site"><a href="/about">About Styx</a></li>
                        <li class="icon-site"><a href="/hc">Help center</a></li>
                        <li class="icon-site"><a href="/">Serendipity Styx Home</a></li>
                        <li class="icon-site"><a href="/blog">Serendipity Styx Blog</a></li>
                        <li class="icon-site"><a href="/book">Serendipity Styx Book [de]</a></li>
                        <li class="icon-site"><a href="/plugins">Serendipity Styx Plugins</a></li>
                        <li class="icon-site"><a href="/themes">Serendipity Styx Themes</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="section-container footer-policy">
        <div class="row">
            <div class="col-xs-12 col-md-6">
                <p class="footer-policy__rights">© 2016 - 2018 Serendipity Styx Edition.</p>
            </div>
            <div class="col-xs-12 col-md-6">
                <ul class="footer-policy__menu">
                    <li class="footer-policy__menu-item"><a href="/legal">Legal</a></li>
                    <li class="footer-policy__menu-item"><a href="/legal/privacy">Privacy policy</a></li>
                    <li class="footer-policy__menu-item"><a href="https://opensource.org/docs/definition.php" target="_blank">Open Source</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
	<svg id="github" viewBox="0 0 24 24">
		<title id="simpleicons-github-icon">GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path>
	</svg>
</svg>

<script src="/js/styx.min.js"></script>
</body></html>